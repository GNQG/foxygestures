<!DOCTYPE html>
<html ng-app="mgOptionsApp" ng-strict-di>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="lib/bootstrap.min.css">
    <link rel="stylesheet" href="lib/font-awesome.min.css">
    <link rel="stylesheet" href="options.css">

    <!-- WebExtension shared components -->
    <script src="../background/commands.js"></script>
    <script src="../content/helpers.js"></script>
    <script src="../content/classes/MouseDeltaAccumulator.js"></script>
    <script src="../content/classes/UDLRGestureDetector.js"></script>
  </head>

  <body ng-controller="OptionsCtrl">
    <!-- Do not show until settings are loaded -->
    <div ng-if="commands.loaded && settings.loaded">

      <form class="form">
        <!-- Gesture button -->
        <div class="form-group">
          <label class="control-label">Gesture Button</label>
          <select class="form-control"
                  ng-model="settings.gestureButton">
            <option ng-value="0">Left</option>
            <option ng-value="1">Middle</option>
            <option ng-value="2">Right</option>
          </select>
          <p class="help-block">
            The mouse button used to start a gesture.
          </p>
        </div>

        <!-- Gesture timeout -->
        <div class="form-group">
          <label class="control-label">Gesture Timeout</label>
          <input class="form-control" type="number"
                 step="0.1" min="0" max="30"
                 ng-model="controls.gestureTimeout"></input>
          <p class="help-block">
            Cancel a gesture if there is no movement for this many seconds. Use zero to disable.
          </p>
        </div>

        <hr>

        <!-- Draw trails -->
        <div class="form-group">
          <div class="checkbox">
            <label>
              <input type="checkbox"
                     ng-model="settings.drawTrails"></input>
              Draw gesture trails
            </label>
          </div>
        </div>

        <fieldset ng-disabled="!settings.drawTrails">
          <!-- Trail width -->
          <div class="form-group">
            <label class="control-label">Trail Width</label>
            <input class="form-control" type="number"
                   step="0.5" min="0" max="5"
                   ng-model="settings.trailWidth"></input>
          </div>

          <!-- Trail color -->
          <div class="form-group">
            <label class="control-label">Trail Color</label>
            <input class="form-control" type="text"
                   ng-model="settings.trailColor"
                   ng-model-options="{ updateOn: 'blur' }"></input>
            <p class="help-block">
              Any CSS color definition is accepted. e.g.: blue, #336699, or rgba(64, 128, 192, 0.5)
            </p>
          </div>
        </fieldset>
      </form>

      <hr>

      <div class="section-help-block">
        <label>Built-in Gestures</label>
        <p class="help-block">
          Perform a gesture in each box to assign the gesture for the command.
          Press and release the gesture button to clear the gesture.
        </p>
      </div>

      <hr>

      <!-- List of gesture mappings -->
      <div class="mapping-list tile">

        <div class="mapping-item"
             ng-repeat="command in commands">

          <label class="control-label command-label">
             {{command.label}}
             <i class="fa fa-question-circle"
                ng-if="command.tooltip"
                uib-tooltip="{{command.tooltip}}"></i>
          </label>

          <input class="form-control mapped-gesture"
                  ng-value="getMappingForCommand(command).gesture"
                  disabled="disabled"></input>

          <canvas mg-gesture-input width="150" height="100"
                   settings="settings"
                   gesture="getMappingForCommand(command).gesture"
                   on-gesture="assignGesture(gesture, command)"></canvas>

        </div>

      </div>

    </div>

    <!-- Library components -->
    <script src="lib/angular.min.js"></script>
    <script src="lib/ui-bootstrap-custom-tpls.min.js"></script>
    <script src="options.js"></script>

  </body>

</html>
